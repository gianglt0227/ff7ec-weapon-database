<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>FF7EC Weapon Database</title>
    <!-- Legacy Styles & Scripts -->
    <link rel="stylesheet" href="css/styles.css"> <!-- Kept for table styles mostly, might need overrides -->
    <link rel="stylesheet" href="https://cdn.datatables.net/2.1.8/css/dataTables.dataTables.css">

    <!-- Modern Styles -->
    <link rel="stylesheet" href="dist/output.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&amp;family=Inter:wght@300;400;500;600&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />

    <!-- Logic Scripts -->
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://cdn.datatables.net/2.1.8/js/dataTables.js"></script>
    <script src="js/scripts.js"></script>



</head>

<body
    class="bg-background-light dark:bg-background-dark text-text-main-light dark:text-text-main-dark font-sans min-h-screen flex flex-col transition-colors duration-300">
    <header
        class="bg-card-light dark:bg-card-dark shadow-sm border-b border-gray-200 dark:border-gray-800 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-20 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <span class="material-symbols-outlined text-primary text-4xl">hardware</span>
                <h1 class="font-display text-2xl md:text-3xl font-bold text-gray-900 dark:text-white tracking-tight">
                    FF7EC <span class="text-primary">Weapon DB</span>
                </h1>
            </div>
            <div class="flex items-center gap-4">
                <button aria-label="Toggle theme"
                    class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"
                    onclick="document.documentElement.classList.toggle('dark')">
                    <span class="material-symbols-outlined dark:hidden text-gray-600">dark_mode</span>
                    <span class="material-symbols-outlined hidden dark:block text-yellow-400">light_mode</span>
                </button>
            </div>
        </div>
    </header>
    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 w-full relative z-0">
        <div class="text-center mb-12">
            <h2 class="text-4xl md:text-5xl font-display font-bold mb-4 text-gray-800 dark:text-gray-100">
                Find Your Arsenal
            </h2>
            <p class="text-lg text-text-muted-light dark:text-text-muted-dark max-w-2xl mx-auto mb-8">
                The most comprehensive weapon database for Final Fantasy VII Ever Crisis.
            </p>

            <!-- Search Container mapped to scripts.js expectations where possible -->
            <div class="relative inline-block text-left w-full max-w-md mx-auto group">
                <!-- Added onclick="ecSearch()" to match legacy behavior, though we might need to suppress the default script toggle if we use custom JS below -->
                <button onclick="ecSearch()" aria-expanded="true" aria-haspopup="true"
                    class="inline-flex w-full justify-center items-center gap-2 rounded-lg border border-transparent bg-primary px-6 py-4 text-lg font-semibold text-white shadow-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-all transform hover:-translate-y-0.5"
                    id="searchButton" type="button">
                    <span class="material-symbols-outlined">search</span>
                    Database Search
                    <span class="material-symbols-outlined ml-auto">expand_more</span>
                </button>

                <!-- ID ecDropdown is REQUIRED by scripts.js line 14: document.getElementById("ecDropdown").classList.toggle("show"); -->
                <!-- We add class "dropdown-content" if scripts.js uses it for styling, but mainly we need the ID -->
                <div class="absolute left-0 right-0 z-50 mt-2 w-full origin-top rounded-xl bg-card-light dark:bg-card-dark shadow-2xl ring-1 ring-black ring-opacity-5 focus:outline-none fade-in border border-gray-100 dark:border-gray-700 overflow-hidden dropdown-content"
                    id="ecDropdown">
                    <div class="max-h-[60vh] overflow-y-auto" id="searchDropdownContent">

                        <!-- Header: Elements -->
                        <div
                            class="px-4 py-2 bg-gray-50/50 dark:bg-gray-800/30 sticky top-0 backdrop-blur-sm z-10 border-b border-gray-100 dark:border-gray-700">
                            <span
                                class="text-xs font-bold text-text-muted-light dark:text-text-muted-dark uppercase tracking-wider">Elements</span>
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-0.5 p-2">
                            <a onclick="filterFire()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-red-50 hover:text-red-600 dark:hover:bg-red-900/20 dark:hover:text-red-400 rounded-md transition-colors group">
                                <span
                                    class="w-2 h-2 rounded-full bg-red-500 mr-3 group-hover:scale-125 transition-transform"></span>
                                Fire
                            </a>
                            <a onclick="filterIce()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-cyan-50 hover:text-cyan-600 dark:hover:bg-cyan-900/20 dark:hover:text-cyan-400 rounded-md transition-colors group">
                                <span
                                    class="w-2 h-2 rounded-full bg-cyan-400 mr-3 group-hover:scale-125 transition-transform"></span>
                                Ice
                            </a>
                            <a onclick="filterLightning()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-yellow-50 hover:text-yellow-600 dark:hover:bg-yellow-900/20 dark:hover:text-yellow-400 rounded-md transition-colors group">
                                <span
                                    class="w-2 h-2 rounded-full bg-yellow-400 mr-3 group-hover:scale-125 transition-transform"></span>
                                Lightning
                            </a>
                            <a onclick="filterWater()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-blue-50 hover:text-blue-600 dark:hover:bg-blue-900/20 dark:hover:text-blue-400 rounded-md transition-colors group">
                                <span
                                    class="w-2 h-2 rounded-full bg-blue-500 mr-3 group-hover:scale-125 transition-transform"></span>
                                Water
                            </a>
                            <a onclick="filterWind()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-green-50 hover:text-green-600 dark:hover:bg-green-900/20 dark:hover:text-green-400 rounded-md transition-colors group">
                                <span
                                    class="w-2 h-2 rounded-full bg-green-500 mr-3 group-hover:scale-125 transition-transform"></span>
                                Wind
                            </a>
                            <a onclick="filterEarth()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-orange-50 hover:text-orange-600 dark:hover:bg-orange-900/20 dark:hover:text-orange-400 rounded-md transition-colors group">
                                <span
                                    class="w-2 h-2 rounded-full bg-orange-600 mr-3 group-hover:scale-125 transition-transform"></span>
                                Earth
                            </a>
                            <a onclick="filterNonElem()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-100 hover:text-gray-900 dark:hover:bg-gray-700 dark:hover:text-white rounded-md transition-colors group sm:col-span-2">
                                <span
                                    class="w-2 h-2 rounded-full bg-gray-400 mr-3 group-hover:scale-125 transition-transform"></span>
                                Non-Elemental
                            </a>
                        </div>

                        <!-- Header: Debuffs -->
                        <div
                            class="px-4 py-2 bg-gray-50/50 dark:bg-gray-800/30 sticky top-0 backdrop-blur-sm z-10 border-y border-gray-100 dark:border-gray-700">
                            <span
                                class="text-xs font-bold text-text-muted-light dark:text-text-muted-dark uppercase tracking-wider">Debuffs</span>
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-0.5 p-2">
                            <a onclick="filterPatkDown()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-purple-50 hover:text-purple-700 dark:hover:bg-purple-900/20 dark:hover:text-purple-300 rounded-md transition-colors">
                                <span
                                    class="material-symbols-outlined text-sm mr-2 text-purple-500">trending_down</span>
                                PATK
                            </a>
                            <a onclick="filterMatkDown()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-purple-50 hover:text-purple-700 dark:hover:bg-purple-900/20 dark:hover:text-purple-300 rounded-md transition-colors">
                                <span
                                    class="material-symbols-outlined text-sm mr-2 text-purple-500">trending_down</span>
                                MATK
                            </a>
                            <a onclick="filterPdefDown()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-purple-50 hover:text-purple-700 dark:hover:bg-purple-900/20 dark:hover:text-purple-300 rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-2 text-purple-500">shield</span> PDEF
                            </a>
                            <a onclick="filterMdefDown()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-purple-50 hover:text-purple-700 dark:hover:bg-purple-900/20 dark:hover:text-purple-300 rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-2 text-purple-500">shield</span> MDEF
                            </a>
                        </div>

                        <!-- Header: Buffs -->
                        <div
                            class="px-4 py-2 bg-gray-50/50 dark:bg-gray-800/30 sticky top-0 backdrop-blur-sm z-10 border-y border-gray-100 dark:border-gray-700">
                            <span
                                class="text-xs font-bold text-text-muted-light dark:text-text-muted-dark uppercase tracking-wider">Buffs</span>
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-0.5 p-2">
                            <a onclick="filterPatkUp()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-indigo-50 hover:text-indigo-700 dark:hover:bg-indigo-900/20 dark:hover:text-indigo-300 rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-2 text-indigo-500">trending_up</span>
                                PATK
                            </a>
                            <a onclick="filterMatkUp()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-indigo-50 hover:text-indigo-700 dark:hover:bg-indigo-900/20 dark:hover:text-indigo-300 rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-2 text-indigo-500">trending_up</span>
                                MATK
                            </a>
                            <a onclick="filterPdefUp()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-indigo-50 hover:text-indigo-700 dark:hover:bg-indigo-900/20 dark:hover:text-indigo-300 rounded-md transition-colors">
                                <span
                                    class="material-symbols-outlined text-sm mr-2 text-indigo-500">shield_with_heart</span>
                                PDEF
                            </a>
                            <a onclick="filterMdefUp()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-indigo-50 hover:text-indigo-700 dark:hover:bg-indigo-900/20 dark:hover:text-indigo-300 rounded-md transition-colors">
                                <span
                                    class="material-symbols-outlined text-sm mr-2 text-indigo-500">shield_with_heart</span>
                                MDEF
                            </a>
                            <a onclick="filterExploitWeakness()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-indigo-50 hover:text-indigo-700 dark:hover:bg-indigo-900/20 dark:hover:text-indigo-300 rounded-md transition-colors sm:col-span-2">
                                <span class="material-symbols-outlined text-sm mr-2 text-indigo-500">target</span>
                                Exploit Weakness
                            </a>
                        </div>

                        <!-- Header: Utility -->
                        <div
                            class="px-4 py-2 bg-gray-50/50 dark:bg-gray-800/30 sticky top-0 backdrop-blur-sm z-10 border-y border-gray-100 dark:border-gray-700">
                            <span
                                class="text-xs font-bold text-text-muted-light dark:text-text-muted-dark uppercase tracking-wider">Utility
                                &amp; Misc</span>
                        </div>
                        <div class="p-2 space-y-1">
                            <a onclick="filterHeal()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-green-50 hover:text-green-700 dark:hover:bg-green-900/20 dark:hover:text-green-300 rounded-md transition-colors">
                                <span
                                    class="material-symbols-outlined text-sm mr-3 text-green-500">medical_services</span>
                                Heal
                            </a>
                            <a onclick="filterProvoke()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 hover:text-gray-900 dark:hover:bg-gray-700 rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-3 text-gray-400">campaign</span>
                                Provoke/Veil
                            </a>
                            <a onclick="filterLimited()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-yellow-50 hover:text-yellow-700 dark:hover:bg-yellow-900/20 dark:hover:text-yellow-300 rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-3 text-yellow-500">star</span>
                                Limited/Crossover
                            </a>
                        </div>

                        <!-- Header: Sigils -->
                        <div
                            class="px-4 py-2 bg-gray-50/50 dark:bg-gray-800/30 sticky top-0 backdrop-blur-sm z-10 border-y border-gray-100 dark:border-gray-700">
                            <span
                                class="text-xs font-bold text-text-muted-light dark:text-text-muted-dark uppercase tracking-wider">Sigils</span>
                        </div>
                        <div class="grid grid-cols-2 gap-0.5 p-2">
                            <a onclick="filterCircleSigilMateria()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 hover:text-primary dark:hover:bg-gray-700 dark:hover:text-primary rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-2 text-gray-400">circle</span> O Sigil
                            </a>
                            <a onclick="filterTriangleSigilMateria()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 hover:text-primary dark:hover:bg-gray-700 dark:hover:text-primary rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-2 text-gray-400">change_history</span>
                                Δ Sigil
                            </a>
                            <a onclick="filterXSigilMateria()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 hover:text-primary dark:hover:bg-gray-700 dark:hover:text-primary rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-2 text-gray-400">close</span> X Sigil
                            </a>
                            <a onclick="filterDiamondMateria()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 hover:text-primary dark:hover:bg-gray-700 dark:hover:text-primary rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-2 text-gray-400">diamond</span> ◇
                                Sigil
                            </a>
                        </div>

                        <!-- Header: Unique -->
                        <div class="p-2 border-t border-gray-100 dark:border-gray-700">
                            <a onclick="filterUniqueEffect()"
                                class="cursor-pointer flex items-center px-4 py-3 text-sm text-gray-700 dark:text-gray-200 hover:bg-purple-50 hover:text-purple-700 dark:hover:bg-purple-900/20 dark:hover:text-purple-300 rounded-md transition-colors">
                                <span
                                    class="material-symbols-outlined text-sm mr-3 text-purple-500">auto_fix_high</span>
                                Status/Enfeeble/Stop/Unique
                            </a>
                        </div>

                        <!-- ALL WEAPONS -->
                        <div
                            class="p-2 border-t border-gray-100 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-800/20">
                            <a onclick="filterAll()"
                                class="cursor-pointer flex items-center justify-center px-4 py-3 text-sm font-semibold text-primary hover:text-white hover:bg-primary dark:hover:bg-primary dark:hover:text-white rounded-md transition-all">
                                View All Weapons
                                <span class="material-symbols-outlined text-sm ml-2">arrow_forward</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div
                class="mt-6 flex flex-col items-center justify-center gap-2 text-sm text-text-muted-light dark:text-text-muted-dark">
                <div class="flex items-center gap-2">
                    <span class="material-symbols-outlined text-base">update</span>
                    <span>Last database update: <span id="lastUpdateDate">Loading...</span></span>
                </div>
            </div>
        </div>

        <!-- Character Filter Section -->
        <div id="characterFilterContainer"
            class="hidden mb-6 bg-card-light dark:bg-card-dark rounded-xl shadow-sm border border-gray-200 dark:border-gray-800 p-4 fade-in">
            <div class="flex items-center justify-between mb-3">
                <h3
                    class="text-sm font-semibold text-gray-900 dark:text-white uppercase tracking-wider flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary">filter_alt</span>
                    Filter by Character (All are selected by default)
                </h3>
                <div class="flex gap-2">
                    <button onclick="selectAllCharacters()"
                        class="text-xs text-primary hover:text-primary-dark font-medium transition-colors">Select
                        All</button>
                    <span class="text-gray-300 dark:text-gray-700">|</span>
                    <button onclick="deselectAllCharacters()"
                        class="text-xs text-text-muted-light dark:text-text-muted-dark hover:text-gray-900 dark:hover:text-gray-100 font-medium transition-colors">Clear</button>
                </div>
            </div>
            <div id="characterFilterButtons" class="flex flex-wrap gap-2">
                <!-- Buttons will be injected here -->
            </div>
        </div>

        <!-- Output Section: ID must be "Output" for scripts.js -->
        <div class="space-y-8 animate-fade-in output" id="Output" style="min-height: 200px;">
            <!-- scripts.js writes the entire table structure here -->
        </div>

    </main>
    <footer class="bg-card-light dark:bg-card-dark border-t border-gray-200 dark:border-gray-800 mt-auto">
        <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-white tracking-wider uppercase mb-4">
                        Credits</h3>
                    <div class="space-y-3 text-sm text-text-muted-light dark:text-text-muted-dark">
                        <div class="flex items-center gap-2">
                            <span class="material-symbols-outlined text-primary text-sm">code</span>
                            <span>Special thanks to <strong>gianglt0227</strong> for GUI contributions.</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="material-symbols-outlined text-primary text-sm">bug_report</span>
                            <span>Database bugs? Contact <strong>Nilu(cia)</strong> on Discord.</span>
                        </div>
                    </div>
                </div>
                <div class="md:text-right">
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-white tracking-wider uppercase mb-4">
                        Contact</h3>
                    <div class="space-y-3 text-sm text-text-muted-light dark:text-text-muted-dark">
                        <p>For other issues/filters, contact <strong>Cantiga</strong> on Discord.</p>
                        <p class="text-xs mt-4">© 2024 Unofficial FF7EC Database. Not affiliated with Square Enix.</p>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <script src="js/character-filter.js"></script>
    <script src="js/table-renderer.js"></script>
    <script defer src="js/ui-dropdown.js"></script>
    <script defer src="js/last-update.js"></script>

</body>

</html>