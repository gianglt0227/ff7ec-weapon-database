<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>FF7EC Weapon Database</title>
    <!-- Legacy Styles & Scripts -->
    <link rel="stylesheet" href="styles.css"> <!-- Kept for table styles mostly, might need overrides -->
    <link rel="stylesheet" href="https://cdn.datatables.net/2.1.8/css/dataTables.dataTables.css">

    <!-- Modern Styles -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&amp;family=Inter:wght@300;400;500;600&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />

    <!-- Logic Scripts -->
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://cdn.datatables.net/2.1.8/js/dataTables.js"></script>
    <script src="scripts.js"></script>

    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#10B981",
                        "primary-dark": "#059669",
                        "background-light": "#FFF7ED",
                        "background-dark": "#18181B",
                        "card-light": "#FFFFFF",
                        "card-dark": "#27272A",
                        "text-main-light": "#3F3F46",
                        "text-main-dark": "#E4E4E7",
                        "text-muted-light": "#71717A",
                        "text-muted-dark": "#A1A1AA",
                    },
                    fontFamily: {
                        display: ["Cinzel", "serif"],
                        sans: ["Inter", "sans-serif"],
                    },
                },
            },
        };
    </script>
    <style>
        .custom-scrollbar::-webkit-scrollbar {
            height: 8px;
            width: 8px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #CBD5E1;
            border-radius: 4px;
        }

        .dark .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #4B5563;
        }

        .fade-in {
            animation: fadeIn 0.2s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Ensure DataTables fits roughly within the theme - Minimal overrides */
        .dataTables_wrapper {
            padding: 10px;
        }

        table.dataTable {
            width: 100% !important;
        }

        /* FIX: Override legacy styles.css which sets .dropdown-content a { display: block } */
        /* This restores the flex layout needed for the icons/dots to show */
        #ecDropdown a {
            display: flex !important;
            align-items: center;
        }

        /* Modernize DataTables Search */
        .dataTables_filter {
            margin-bottom: 1rem;
            display: flex;
            justify-content: flex-end;
            align-items: center;
            padding: 0 1rem;
            /* align with container padding if any, or just spacing */
        }

        .dataTables_filter label {
            font-size: 0.875rem;
            color: #4B5563;
            /* text-gray-600 */
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .dataTables_filter input {
            border: 1px solid #E5E7EB;
            /* border-gray-200 */
            border-radius: 0.5rem;
            /* rounded-lg */
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            outline: none;
            transition: all 0.2s;
            margin-left: 0.5rem;
        }

        .dataTables_filter input:focus {
            border-color: #10B981;
            /* primary */
            box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.1);
        }

        .dark .dataTables_filter label {
            color: #D1D5DB;
            /* text-gray-300 */
        }

        .dark .dataTables_filter input {
            background-color: #27272A;
            /* bg-card-dark */
            border-color: #3f3f46;
            /* border-gray-700 */
            color: white;
        }

        /* Hide the old dropdown mechanic styles if they conflict, but scripts.js toggles .show on #ecDropdown */
        /* We will map the new visual dropdown to the ID ecDropdown */
    </style>
</head>

<body
    class="bg-background-light dark:bg-background-dark text-text-main-light dark:text-text-main-dark font-sans min-h-screen flex flex-col transition-colors duration-300">
    <header
        class="bg-card-light dark:bg-card-dark shadow-sm border-b border-gray-200 dark:border-gray-800 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-20 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <span class="material-symbols-outlined text-primary text-4xl">hardware</span>
                <h1 class="font-display text-2xl md:text-3xl font-bold text-gray-900 dark:text-white tracking-tight">
                    FF7EC <span class="text-primary">Weapon DB</span>
                </h1>
            </div>
            <div class="flex items-center gap-4">
                <button aria-label="Toggle theme"
                    class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"
                    onclick="document.documentElement.classList.toggle('dark')">
                    <span class="material-symbols-outlined dark:hidden text-gray-600">dark_mode</span>
                    <span class="material-symbols-outlined hidden dark:block text-yellow-400">light_mode</span>
                </button>
            </div>
        </div>
    </header>
    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 w-full relative z-0">
        <div class="text-center mb-12">
            <h2 class="text-4xl md:text-5xl font-display font-bold mb-4 text-gray-800 dark:text-gray-100">
                Find Your Arsenal
            </h2>
            <p class="text-lg text-text-muted-light dark:text-text-muted-dark max-w-2xl mx-auto mb-8">
                The most comprehensive weapon database for Final Fantasy VII Ever Crisis.
            </p>

            <!-- Search Container mapped to scripts.js expectations where possible -->
            <div class="relative inline-block text-left w-full max-w-md mx-auto group">
                <!-- Added onclick="ecSearch()" to match legacy behavior, though we might need to suppress the default script toggle if we use custom JS below -->
                <button onclick="ecSearch()" aria-expanded="true" aria-haspopup="true"
                    class="inline-flex w-full justify-center items-center gap-2 rounded-lg border border-transparent bg-primary px-6 py-4 text-lg font-semibold text-white shadow-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-all transform hover:-translate-y-0.5"
                    id="searchButton" type="button">
                    <span class="material-symbols-outlined">search</span>
                    Database Search
                    <span class="material-symbols-outlined ml-auto">expand_more</span>
                </button>

                <!-- ID ecDropdown is REQUIRED by scripts.js line 14: document.getElementById("ecDropdown").classList.toggle("show"); -->
                <!-- We add class "dropdown-content" if scripts.js uses it for styling, but mainly we need the ID -->
                <div class="absolute left-0 right-0 z-50 mt-2 w-full origin-top rounded-xl bg-card-light dark:bg-card-dark shadow-2xl ring-1 ring-black ring-opacity-5 focus:outline-none fade-in border border-gray-100 dark:border-gray-700 overflow-hidden dropdown-content"
                    id="ecDropdown">
                    <div class="max-h-[60vh] overflow-y-auto" id="searchDropdownContent">

                        <!-- Header: Elements -->
                        <div
                            class="px-4 py-2 bg-gray-50/50 dark:bg-gray-800/30 sticky top-0 backdrop-blur-sm z-10 border-b border-gray-100 dark:border-gray-700">
                            <span
                                class="text-xs font-bold text-text-muted-light dark:text-text-muted-dark uppercase tracking-wider">Elements</span>
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-0.5 p-2">
                            <a onclick="filterFire()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-red-50 hover:text-red-600 dark:hover:bg-red-900/20 dark:hover:text-red-400 rounded-md transition-colors group">
                                <span
                                    class="w-2 h-2 rounded-full bg-red-500 mr-3 group-hover:scale-125 transition-transform"></span>
                                Fire
                            </a>
                            <a onclick="filterIce()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-cyan-50 hover:text-cyan-600 dark:hover:bg-cyan-900/20 dark:hover:text-cyan-400 rounded-md transition-colors group">
                                <span
                                    class="w-2 h-2 rounded-full bg-cyan-400 mr-3 group-hover:scale-125 transition-transform"></span>
                                Ice
                            </a>
                            <a onclick="filterLightning()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-yellow-50 hover:text-yellow-600 dark:hover:bg-yellow-900/20 dark:hover:text-yellow-400 rounded-md transition-colors group">
                                <span
                                    class="w-2 h-2 rounded-full bg-yellow-400 mr-3 group-hover:scale-125 transition-transform"></span>
                                Lightning
                            </a>
                            <a onclick="filterWater()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-blue-50 hover:text-blue-600 dark:hover:bg-blue-900/20 dark:hover:text-blue-400 rounded-md transition-colors group">
                                <span
                                    class="w-2 h-2 rounded-full bg-blue-500 mr-3 group-hover:scale-125 transition-transform"></span>
                                Water
                            </a>
                            <a onclick="filterWind()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-green-50 hover:text-green-600 dark:hover:bg-green-900/20 dark:hover:text-green-400 rounded-md transition-colors group">
                                <span
                                    class="w-2 h-2 rounded-full bg-green-500 mr-3 group-hover:scale-125 transition-transform"></span>
                                Wind
                            </a>
                            <a onclick="filterEarth()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-orange-50 hover:text-orange-600 dark:hover:bg-orange-900/20 dark:hover:text-orange-400 rounded-md transition-colors group">
                                <span
                                    class="w-2 h-2 rounded-full bg-orange-600 mr-3 group-hover:scale-125 transition-transform"></span>
                                Earth
                            </a>
                            <a onclick="filterNonElem()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-100 hover:text-gray-900 dark:hover:bg-gray-700 dark:hover:text-white rounded-md transition-colors group sm:col-span-2">
                                <span
                                    class="w-2 h-2 rounded-full bg-gray-400 mr-3 group-hover:scale-125 transition-transform"></span>
                                Non-Elemental
                            </a>
                        </div>

                        <!-- Header: Debuffs -->
                        <div
                            class="px-4 py-2 bg-gray-50/50 dark:bg-gray-800/30 sticky top-0 backdrop-blur-sm z-10 border-y border-gray-100 dark:border-gray-700">
                            <span
                                class="text-xs font-bold text-text-muted-light dark:text-text-muted-dark uppercase tracking-wider">Debuffs</span>
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-0.5 p-2">
                            <a onclick="filterPatkDown()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-purple-50 hover:text-purple-700 dark:hover:bg-purple-900/20 dark:hover:text-purple-300 rounded-md transition-colors">
                                <span
                                    class="material-symbols-outlined text-sm mr-2 text-purple-500">trending_down</span>
                                PATK
                            </a>
                            <a onclick="filterMatkDown()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-purple-50 hover:text-purple-700 dark:hover:bg-purple-900/20 dark:hover:text-purple-300 rounded-md transition-colors">
                                <span
                                    class="material-symbols-outlined text-sm mr-2 text-purple-500">trending_down</span>
                                MATK
                            </a>
                            <a onclick="filterPdefDown()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-purple-50 hover:text-purple-700 dark:hover:bg-purple-900/20 dark:hover:text-purple-300 rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-2 text-purple-500">shield</span> PDEF
                            </a>
                            <a onclick="filterMdefDown()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-purple-50 hover:text-purple-700 dark:hover:bg-purple-900/20 dark:hover:text-purple-300 rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-2 text-purple-500">shield</span> MDEF
                            </a>
                        </div>

                        <!-- Header: Buffs -->
                        <div
                            class="px-4 py-2 bg-gray-50/50 dark:bg-gray-800/30 sticky top-0 backdrop-blur-sm z-10 border-y border-gray-100 dark:border-gray-700">
                            <span
                                class="text-xs font-bold text-text-muted-light dark:text-text-muted-dark uppercase tracking-wider">Buffs</span>
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-0.5 p-2">
                            <a onclick="filterPatkUp()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-indigo-50 hover:text-indigo-700 dark:hover:bg-indigo-900/20 dark:hover:text-indigo-300 rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-2 text-indigo-500">trending_up</span>
                                PATK
                            </a>
                            <a onclick="filterMatkUp()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-indigo-50 hover:text-indigo-700 dark:hover:bg-indigo-900/20 dark:hover:text-indigo-300 rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-2 text-indigo-500">trending_up</span>
                                MATK
                            </a>
                            <a onclick="filterPdefUp()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-indigo-50 hover:text-indigo-700 dark:hover:bg-indigo-900/20 dark:hover:text-indigo-300 rounded-md transition-colors">
                                <span
                                    class="material-symbols-outlined text-sm mr-2 text-indigo-500">shield_with_heart</span>
                                PDEF
                            </a>
                            <a onclick="filterMdefUp()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-indigo-50 hover:text-indigo-700 dark:hover:bg-indigo-900/20 dark:hover:text-indigo-300 rounded-md transition-colors">
                                <span
                                    class="material-symbols-outlined text-sm mr-2 text-indigo-500">shield_with_heart</span>
                                MDEF
                            </a>
                            <a onclick="filterExploitWeakness()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-indigo-50 hover:text-indigo-700 dark:hover:bg-indigo-900/20 dark:hover:text-indigo-300 rounded-md transition-colors sm:col-span-2">
                                <span class="material-symbols-outlined text-sm mr-2 text-indigo-500">target</span>
                                Exploit Weakness
                            </a>
                        </div>

                        <!-- Header: Utility -->
                        <div
                            class="px-4 py-2 bg-gray-50/50 dark:bg-gray-800/30 sticky top-0 backdrop-blur-sm z-10 border-y border-gray-100 dark:border-gray-700">
                            <span
                                class="text-xs font-bold text-text-muted-light dark:text-text-muted-dark uppercase tracking-wider">Utility
                                &amp; Misc</span>
                        </div>
                        <div class="p-2 space-y-1">
                            <a onclick="filterHeal()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-green-50 hover:text-green-700 dark:hover:bg-green-900/20 dark:hover:text-green-300 rounded-md transition-colors">
                                <span
                                    class="material-symbols-outlined text-sm mr-3 text-green-500">medical_services</span>
                                Heal
                            </a>
                            <a onclick="filterProvoke()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 hover:text-gray-900 dark:hover:bg-gray-700 rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-3 text-gray-400">campaign</span>
                                Provoke/Veil
                            </a>
                            <a onclick="filterLimited()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-yellow-50 hover:text-yellow-700 dark:hover:bg-yellow-900/20 dark:hover:text-yellow-300 rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-3 text-yellow-500">star</span>
                                Limited/Crossover
                            </a>
                        </div>

                        <!-- Header: Sigils -->
                        <div
                            class="px-4 py-2 bg-gray-50/50 dark:bg-gray-800/30 sticky top-0 backdrop-blur-sm z-10 border-y border-gray-100 dark:border-gray-700">
                            <span
                                class="text-xs font-bold text-text-muted-light dark:text-text-muted-dark uppercase tracking-wider">Sigils</span>
                        </div>
                        <div class="grid grid-cols-2 gap-0.5 p-2">
                            <a onclick="filterCircleSigilMateria()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 hover:text-primary dark:hover:bg-gray-700 dark:hover:text-primary rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-2 text-gray-400">circle</span> O Sigil
                            </a>
                            <a onclick="filterTriangleSigilMateria()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 hover:text-primary dark:hover:bg-gray-700 dark:hover:text-primary rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-2 text-gray-400">change_history</span>
                                Δ Sigil
                            </a>
                            <a onclick="filterXSigilMateria()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 hover:text-primary dark:hover:bg-gray-700 dark:hover:text-primary rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-2 text-gray-400">close</span> X Sigil
                            </a>
                            <a onclick="filterDiamondMateria()"
                                class="cursor-pointer flex items-center px-4 py-2.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 hover:text-primary dark:hover:bg-gray-700 dark:hover:text-primary rounded-md transition-colors">
                                <span class="material-symbols-outlined text-sm mr-2 text-gray-400">diamond</span> ◇
                                Sigil
                            </a>
                        </div>

                        <!-- Header: Unique -->
                        <div class="p-2 border-t border-gray-100 dark:border-gray-700">
                            <a onclick="filterUniqueEffect()"
                                class="cursor-pointer flex items-center px-4 py-3 text-sm text-gray-700 dark:text-gray-200 hover:bg-purple-50 hover:text-purple-700 dark:hover:bg-purple-900/20 dark:hover:text-purple-300 rounded-md transition-colors">
                                <span
                                    class="material-symbols-outlined text-sm mr-3 text-purple-500">auto_fix_high</span>
                                Status/Enfeeble/Stop/Unique
                            </a>
                        </div>

                        <!-- ALL WEAPONS -->
                        <div
                            class="p-2 border-t border-gray-100 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-800/20">
                            <a onclick="filterAll()"
                                class="cursor-pointer flex items-center justify-center px-4 py-3 text-sm font-semibold text-primary hover:text-white hover:bg-primary dark:hover:bg-primary dark:hover:text-white rounded-md transition-all">
                                View All Weapons
                                <span class="material-symbols-outlined text-sm ml-2">arrow_forward</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div
                class="mt-6 flex flex-col items-center justify-center gap-2 text-sm text-text-muted-light dark:text-text-muted-dark">
                <div class="flex items-center gap-2">
                    <span class="material-symbols-outlined text-base">update</span>
                    <span>Last database update: <span id="lastUpdateDate">Loading...</span></span>
                </div>
            </div>
        </div>

        <!-- Output Section: ID must be "Output" for scripts.js -->
        <div class="space-y-8 animate-fade-in output" id="Output" style="min-height: 200px;">
            <!-- scripts.js writes the entire table structure here -->
        </div>

    </main>
    <footer class="bg-card-light dark:bg-card-dark border-t border-gray-200 dark:border-gray-800 mt-auto">
        <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-white tracking-wider uppercase mb-4">
                        Credits</h3>
                    <div class="space-y-3 text-sm text-text-muted-light dark:text-text-muted-dark">
                        <div class="flex items-center gap-2">
                            <span class="material-symbols-outlined text-primary text-sm">code</span>
                            <span>Special thanks to <strong>gianglt0227</strong> for GUI contributions.</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="material-symbols-outlined text-primary text-sm">bug_report</span>
                            <span>Database bugs? Contact <strong>Nilu(cia)</strong> on Discord.</span>
                        </div>
                    </div>
                </div>
                <div class="md:text-right">
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-white tracking-wider uppercase mb-4">
                        Contact</h3>
                    <div class="space-y-3 text-sm text-text-muted-light dark:text-text-muted-dark">
                        <p>For other issues/filters, contact <strong>Cantiga</strong> on Discord.</p>
                        <p class="text-xs mt-4">© 2024 Unofficial FF7EC Database. Not affiliated with Square Enix.</p>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <script>
        // Custom logic to handle the Tailwind Dropdown visual state, syncing with scripts.js expectations
        const searchButton = document.getElementById('searchButton');
        const searchDropdown = document.getElementById('ecDropdown'); // Mapped ID

        // Dropdown close logic
        document.addEventListener('click', (e) => {
            if (!searchButton.contains(e.target) && !searchDropdown.contains(e.target)) {
                if (searchDropdown.classList.contains('show')) {
                    searchDropdown.classList.remove('show');
                }
                searchButton.querySelector('.ml-auto').textContent = 'expand_more';
            } else if (searchDropdown.classList.contains('show')) {
                searchButton.querySelector('.ml-auto').textContent = 'expand_less';
            }
        });

        /**
         * MODERNIZED TABLE GENERATION
         * Overrides the legacy CreateTable function from scripts.js for index3.html only.
         * Uses Tailwind CSS classes matching index2.html design.
         */
        function tableCreate(user_row, user_col, list, header) {
            var body = document.getElementById('Output');

            // Clear previous content handled by parent script, but we ensure structure here
            // body.innerHTML = ''; // FIX: Do not clear here, as multiple tables might be appended in one action (e.g. Fire -> Elem, Resist, etc)

            // 1. Header with Tailwind
            const h1 = document.createElement("h2"); // Use h2 for semantic hierarchy inside main
            h1.className = "text-2xl md:text-3xl font-display font-bold text-gray-800 dark:text-gray-100 mb-6 flex items-center gap-2";
            h1.innerHTML = `<span class="material-symbols-outlined text-primary">analytics</span> ${header}`;
            body.appendChild(h1);

            console.log("Modern Table Data:", list);

            // 2. Container for rounded corners and overflow
            const container = document.createElement("div");
            container.className = "bg-card-light dark:bg-card-dark rounded-xl shadow-lg border border-gray-200 dark:border-gray-800 overflow-hidden mb-8";

            const scrollWrapper = document.createElement("div");
            scrollWrapper.className = "overflow-x-auto custom-scrollbar";
            container.appendChild(scrollWrapper);

            // 3. Table Element
            var tbl = document.createElement("table");
            // Using classes from index2.html
            tbl.className = "min-w-full divide-y divide-gray-200 dark:divide-gray-700 w-full";
            tbl.id = "modernTable" + Math.random().toString(36).substr(2, 9);

            var tblHead = document.createElement("thead");
            tblHead.className = "bg-gray-50 dark:bg-gray-800/50";

            var tblBody = document.createElement("tbody");
            tblBody.className = "divide-y divide-gray-200 dark:divide-gray-700 bg-card-light dark:bg-card-dark";

            var headerRow = document.createElement("tr");

            // 4. Build Rows
            for (var j = 0; j < user_row; j++) {
                var row = document.createElement("tr");
                row.className = "hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors";

                for (var i = 0; i < user_col; i++) {
                    var cell;

                    // HEADER ROW
                    if (j == 0) {
                        cell = document.createElement("th");
                        cell.className = "px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:text-primary group select-none";
                        // Add Click event for sorting (delegating to legacy sort logic via parent node hack if needed, or simple text content pass)
                        // Legacy sortTable expects 'this' to be the cell.
                        cell.onclick = function () { sortTable(this); };

                        // Add sort icon visual
                        let content = list[j][i] || "";
                        cell.innerHTML = `<div class="flex items-center gap-1">${content} <span class="material-symbols-outlined text-sm opacity-50 group-hover:opacity-100">sort</span></div>`;

                        headerRow.appendChild(cell);
                    }
                    // DATA ROW
                    else {
                        cell = document.createElement("td");
                        cell.className = "px-6 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-300";

                        let cellText = list[j][i] || "";

                        // Render Image/Icon logic if we want to be fancy, but raw text for now
                        // Simple formatting for numeric columns
                        if (!isNaN(parseFloat(cellText)) && isFinite(cellText)) {
                            cell.className += " font-mono";
                        }

                        cell.textContent = cellText;
                        row.appendChild(cell);
                    }
                }
                if (j > 0) {
                    tblBody.appendChild(row);
                }
            }

            tblHead.appendChild(headerRow);
            tbl.appendChild(tblHead);
            tbl.appendChild(tblBody);

            scrollWrapper.appendChild(tbl);
            body.appendChild(container);

            // 5. Initialize DataTable (Optional, for advanced features, but might conflict visually)
            // We'll skip complex DataTables init for now to keep the pure Tailwind look, 
            // OR we can applying a minimal config to keep it from destroying our classes.
            // Actually, legacy script relied on DataTables for "paging: false". 
            // Let's re-apply it but be careful.

            new DataTable('#' + tbl.id, {
                paging: false,
                searching: true, // Enable search
                info: false,      // Hide "Showing 1 of..."
                autoWidth: false, // Let Tailwind handle width
                // Force dom structure to avoid injecting legacy classes, but include filter 'f'
                dom: '<"p-4"f>t' // f = filtering input, t = table. Wrapped f in padding div.
            });

            console.log("Created Modern Table");
        }

        /**
         * Display the last update date of weaponData.csv
         * Date is based on the last git commit that modified weaponData.csv
         *
         * To update this date, run:
         * git log -1 --format="%ad" --date=format:'%Y/%m/%d' -- weaponData.csv
         */
        function displayLastUpdateDate() {
            const lastUpdateElement = document.getElementById('lastUpdateDate');
            // This date should be updated when weaponData.csv is modified
            // Run: git log -1 --format="%ad" --date=format:'%Y/%m/%d' -- weaponData.csv
            const lastCommitDate = '2025/11/30';
            lastUpdateElement.textContent = lastCommitDate;
        }

        // Display last update date on page load
        document.addEventListener('DOMContentLoaded', displayLastUpdateDate);

    </script>
</body>

</html>